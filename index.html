// Botão "Acessar Documento"
document.getElementById("acessar-arquivo").onclick = async function () {
  try {
    const token = sessionStorage.getItem("magic-token");
    if (!token) {
      alert("Sessão expirada. Por favor, faça login novamente.");
      return;
    }

    const fileName = "Paper.pdf";

    // URL do Proxy CORS
    const proxyUrl = "https://cors-anywhere.herokuapp.com/";
    const apiUrl = "https://fleek-nine.vercel.app/api/get-file";

    // Fazendo a requisição com o proxy
    const response = await fetch(proxyUrl + apiUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ token, fileName }),
    });

    if (!response.ok) {
      throw new Error(`Erro ao acessar o backend: ${response.statusText}`);
    }

    const pdfBlob = await response.blob();
    await renderPDF(pdfBlob);
  } catch (err) {
    console.error("Erro ao acessar documento:", err.message);
    alert("Ocorreu um erro: " + err.message);
  }
};
